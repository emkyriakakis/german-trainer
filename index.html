<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>German Trainer</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{font-family:system-ui;background:#f3f4f6;margin:0}
header{background:#2563eb;color:white;padding:20px;text-align:center}
main{max-width:800px;margin:auto;padding:20px}
.card{background:white;padding:20px;border-radius:14px;margin-bottom:20px;
box-shadow:0 8px 20px rgba(0,0,0,.1)}
.choice{padding:12px;margin:8px 0;background:#e5e7eb;border-radius:8px;
cursor:pointer}
.choice:hover{background:#dbeafe}
.correct{background:#16a34a;color:white}
.wrong{background:#dc2626;color:white}
button{padding:12px 20px;border:none;border-radius:8px;background:#2563eb;
color:white;font-weight:bold;cursor:pointer}
.progress{background:#e5e7eb;border-radius:10px;height:14px}
.progress div{height:14px;border-radius:10px;background:#16a34a}
</style>
</head>

<body>
<header>
<h1>ðŸ‡©ðŸ‡ª German Trainer</h1>
<p>Multiple-choice â€¢ Adaptive â€¢ Unlimited</p>
</header>

<main>

<div class="card">
<h3>ðŸ“Š Progress</h3>
<div id="progressBox"></div>
</div>

<div class="card">
<h2 id="question"></h2>
<div id="choices"></div>
<div id="feedback"></div>
<button id="nextBtn">Next</button>
</div>

</main>

<script>
/* ====== STATE ====== */
let checked=false;
let current=null;
let streak=0;

let stats=JSON.parse(localStorage.getItem("stats")) || {
  Grammar:{done:0,correct:0},
  Articles:{done:0,correct:0},
  Reading:{done:0,correct:0}
};

/* ====== DATA (CORRECT GERMAN) ====== */
const grammarTemplates=[
  {
    topic:"Grammar",
    q:"Ich lerne Deutsch, ___ ich in der Schweiz arbeite.",
    options:["weil","obwohl","damit"],
    answer:"weil"
  },
  {
    topic:"Grammar",
    q:"Wenn ich mehr Zeit ___, wÃ¼rde ich mehr lesen.",
    options:["hÃ¤tte","habe","hatte"],
    answer:"hÃ¤tte"
  }
];

const articles=[
  {topic:"Articles",q:"___ Apfel ist rot.",options:["Der","Die","Das"],answer:"Der"},
  {topic:"Articles",q:"___ MÃ¤dchen spielt.",options:["Der","Die","Das"],answer:"Das"}
];

const readings=[
  {
    topic:"Reading",
    text:"Anna arbeitet in Basel. Sie lernt Deutsch, weil sie dort lebt.",
    q:"Warum lernt Anna Deutsch?",
    options:[
      "Weil sie in Basel lebt",
      "Weil sie Urlaub macht",
      "Weil sie Lehrerin ist"
    ],
    answer:"Weil sie in Basel lebt"
  }
];

/* ====== GENERATOR ====== */
function generate(){
  const pools=[grammarTemplates,articles,readings];
  const pool=pools[Math.floor(Math.random()*pools.length)];
  return JSON.parse(JSON.stringify(
    pool[Math.floor(Math.random()*pool.length)]
  ));
}

/* ====== RENDER ====== */
function render(){
  checked=false;
  current=generate();
  document.getElementById("feedback").innerHTML="";
  document.getElementById("question").innerHTML =
    current.text ? `<p>${current.text}</p><p>${current.q}</p>` : current.q;

  document.getElementById("choices").innerHTML =
    current.options.map(o =>
      `<div class="choice" onclick="select('${o}',this)">${o}</div>`
    ).join("");
}

/* ====== CHECK ====== */
function select(val,el){
  if(checked) return;
  checked=true;

  const correct = val===current.answer;
  el.classList.add(correct?"correct":"wrong");

  document.getElementById("feedback").innerHTML =
    correct ? "âœ” Correct" : `âœ˜ Correct answer: <b>${current.answer}</b>`;

  stats[current.topic].done++;
  if(correct){stats[current.topic].correct++; streak++}
  else streak=0;

  localStorage.setItem("stats",JSON.stringify(stats));
  renderProgress();
}

/* ====== ENTER HANDLER ====== */
document.addEventListener("keydown",e=>{
  if(e.key==="Enter"){
    if(!checked) return;
    render();
  }
});

/* ====== DASHBOARD ====== */
function renderProgress(){
  const box=document.getElementById("progressBox");
  box.innerHTML="";
  for(let t in stats){
    const s=stats[t];
    const p=s.done?Math.round(s.correct/s.done*100):0;
    box.innerHTML+=`
      <div>${t} (${p}%)</div>
      <div class="progress"><div style="width:${p}%"></div></div>
    `;
  }
}

/* ====== INIT ====== */
renderProgress();
render();
document.getElementById("nextBtn").onclick=render;
</script>
</body>
</html>
